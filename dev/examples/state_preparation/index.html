<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Log-Normal state preparation · QuantumCircuits.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../quickguide/">Quick Start guide</a></li><li><span class="tocitem">Quantum Gates Library</span><ul><li><a class="tocitem" href="../../0_Single-qubit-gates/">Single-qubit gates s</a></li><li><a class="tocitem" href="../../1_Two-qubit-gates/">Two-qubit gates</a></li></ul></li><li><span class="tocitem">Novel algorithm to Simulation on NISQ device</span><ul><li><a class="tocitem" href="../../Simulation/problem_definition/">Problem definition</a></li><li><a class="tocitem" href="../../Simulation/U4_Cartan_decomposition/">U4 - Cartan&#39;s KAK decomposition</a></li><li><a class="tocitem" href="../../Simulation/Trotterization/">Algorithm description</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Log-Normal state preparation</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#The-Problem"><span>2 The Problem</span></a></li><li class="toplevel"><a class="tocitem" href="#The-solution"><span>3 The solution</span></a></li><li><a class="tocitem" href="#.1-The-ansact"><span>3.1 The ansact</span></a></li><li><a class="tocitem" href="#.2-Stage-1-optimization"><span>3.2 Stage 1 - optimization</span></a></li><li><a class="tocitem" href="#.3-Stage-2-optimization"><span>3.3 Stage 2 - optimization</span></a></li><li><a class="tocitem" href="#.4-Export-solution"><span>3.4 Export solution</span></a></li></ul></li></ul></li><li><span class="tocitem">Library References</span><ul><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">QCircuits</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QCircuits/Circuit/">Circuit</a></li><li><a class="tocitem" href="../../QCircuits/Gates/">Gates</a></li><li><a class="tocitem" href="../../QCircuits/Qiskit/">Qiskit</a></li><li><a class="tocitem" href="../../QCircuits/Registers/">Registers</a></li><li><a class="tocitem" href="../../QCircuits/Graph/">Graph</a></li><li><a class="tocitem" href="../../QCircuits/OtherGates/">OtherGates</a></li><li><a class="tocitem" href="../../QCircuits/ComplexGates/">ComplexGates</a></li><li><a class="tocitem" href="../../QCircuits/Instructions/">Instructions</a></li><li><a class="tocitem" href="../../QCircuits/Math/">Math</a></li><li><a class="tocitem" href="../../QCircuits/QBase/">QBase</a></li></ul></li><li><a class="tocitem" href="../../Execute/">Execute</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">QML</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QML/QML/">QML</a></li><li><a class="tocitem" href="../../QML/Optimization/">Optimization</a></li><li><a class="tocitem" href="../../QML/CircuitOptimization/">Gates</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Log-Normal state preparation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Log-Normal state preparation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Adgnitio/QuantumCircuits.jl/blob/main/docs/src/examples/state_preparation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p>This solution was created during participation in <a href="https://www.classiq.io/competition">The Classiq coding competition</a>. The description of the problem definition uses the materials created for these professions and are available in <a href="https://www.classiq.io/competition/state-preparation">Log-Normal state preparation</a>.</p><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">1 Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><p>Many quantum algorithms rely on initializing qubits in a specific state. The promised speedup of the algorithm depends on the ability to prepare the quantum state efficiently. The challenge of preparing a quantum state is an example of a broader use case of compiling isometrics into specific quantum circuit and it is known that, in general, an exponential number of gates, O(2n), are needed.</p><p>One of the popular distributions is the log-normal distribution, used in many places such as in the Black-Scholes model option pricing formula. The log-normal distribution is given by:</p><p class="math-container">\[\begin{equation}
f(x) = \frac{1}{x \sigma \sqrt{2 \pi}} e^{-\frac{(ln(x) - \mu)^2}{2 \sigma^2}}
\end{equation}\]</p><h1 id="The-Problem"><a class="docs-heading-anchor" href="#The-Problem">2 The Problem</a><a id="The-Problem-1"></a><a class="docs-heading-anchor-permalink" href="#The-Problem" title="Permalink"></a></h1><p>Our goal is preparing a log-normal distribution with μ = 0 and σ = 0.1. With fallow conditions:</p><ul><li>Use 9 qubits</li><li>We can choose any mapping between the state vector domain D to the distribution domain (i.e. the discretization) as long as it is continuous.</li><li>The target distribution error should be err &lt; 10−2 , where the metric is the L2 norm.</li></ul><h1 id="The-solution"><a class="docs-heading-anchor" href="#The-solution">3 The solution</a><a id="The-solution-1"></a><a class="docs-heading-anchor-permalink" href="#The-solution" title="Permalink"></a></h1><p>See the file lognormal<em>state</em>preparation.jl which contains the full solution code.</p><h2 id=".1-The-ansact"><a class="docs-heading-anchor" href="#.1-The-ansact">3.1 The ansact</a><a id=".1-The-ansact-1"></a><a class="docs-heading-anchor-permalink" href="#.1-The-ansact" title="Permalink"></a></h2><p>First, we have to choose the ansact. I&#39;ve decided to use ansact which looks like a Christmas tree. We start with the qubits in the midle with u4 gate and then we add the u4 gates up and down.</p><pre><code class="language-julia hljs"># Generate ansact
qr = QuantumRegister(N)
cr = ClassicalRegister(N)
qc = QCircuit(qr, cr)
#add_ent_gate(i, j) = qc.cx(i, j)
add_ent_gate(i, j) = qc.u4(i, j)

#qc.x(4)
for i in 0:3
    add_ent_gate(4-i, 4-i-1)
    add_ent_gate(4+i, 4+i+1)
end

# decompose
qc = decompose(qc)
qc.measure(0:N-1, 0:N-1)

# Random parameter
params = getRandParameters(qc)
setparameters!(qc, params)</code></pre><p><img src="../../assets/examples/lognormal_ansact.png" alt="image"/></p><p>This can be decomposed using U4 - Cartan&#39;s KAK decomposition. Any 2 qubits unitary can be decomposed used 3 cx gate (see the paper <em>&quot;Minimal Universal Two-qubit Quantum Circuits&quot;</em> https://arxiv.org/abs/quant-ph/0308033).</p><pre><code class="nohighlight hljs">       ┌─────────────────────────┐                                             »
q2_0: ─┤ U3(5.6798,4.251,3.5437) ├─────────────────────────────────────────────»
       ├─────────────────────────┴┐                                            »
q2_1: ─┤ U3(5.4414,2.3543,1.2375) ├────────────────────────────────────────────»
      ┌┴──────────────────────────┤                                            »
q2_2: ┤ U3(-5.9265,5.1056,6.2208) ├────────────────────────────────────────────»
      ├───────────────────────────┤      ┌────────────┐┌───┐┌────────────┐     »
q2_3: ┤ U3(-4.7315,1.8799,5.5737) ├───■──┤ Ry(6.4337) ├┤ X ├┤ Ry(1.3762) ├──■──»
      └┬──────────────────────────┤ ┌─┴─┐├────────────┤└─┬─┘└────────────┘┌─┴─┐»
q2_4: ─┤ U3(3.2012,1.7538,2.2764) ├─┤ X ├┤ Rz(1.8803) ├──■────────────────┤ X ├»
      ┌┴──────────────────────────┤ └───┘└────────────┘                   └───┘»
q2_5: ┤ U3(2.2872,5.5116,0.57145) ├────────────────────────────────────────────»
      ├───────────────────────────┴┐                                           »
q2_6: ┤ U3(5.6107,-0.24548,1.3413) ├───────────────────────────────────────────»
      └─┬────────────────────────┬─┘                                           »
q2_7: ──┤ U3(4.0377,1.807,4.352) ├─────────────────────────────────────────────»
       ┌┴────────────────────────┤                                             »
q2_8: ─┤ U3(6.553,5.6364,2.2813) ├─────────────────────────────────────────────»
       └─────────────────────────┘                                             »
c2: 9/═════════════════════════════════════════════════════════════════════════»
                                                                               »
«                                                                                 »
«q2_0: ───────────────────────────────────────────────────────────────────────────»
«                                                                                 »
«q2_1: ───────────────────────────────────────────────────────────────────────────»
«                                         ┌──────────────┐┌───┐┌────────────┐     »
«q2_2: ────────────────────────────────■──┤ Ry(-0.65543) ├┤ X ├┤ Ry(6.1005) ├──■──»
«       ┌──────────────────────────┐ ┌─┴─┐└┬────────────┬┘└─┬─┘└────────────┘┌─┴─┐»
«q2_3: ─┤ U3(2.1115,2.6476,5.3022) ├─┤ X ├─┤ Rz(1.9143) ├───■────────────────┤ X ├»
«      ┌┴──────────────────────────┴┐├───┤ ├────────────┤                    ├───┤»
«q2_4: ┤ U3(3.6171,-0.88801,1.6704) ├┤ X ├─┤ Rz(3.8027) ├───■────────────────┤ X ├»
«      └────────────────────────────┘└─┬─┘┌┴────────────┤ ┌─┴─┐┌────────────┐└─┬─┘»
«q2_5: ────────────────────────────────■──┤ Ry(0.47131) ├─┤ X ├┤ Ry(4.9733) ├──■──»
«                                         └─────────────┘ └───┘└────────────┘     »
«q2_6: ───────────────────────────────────────────────────────────────────────────»
«                                                                                 »
«q2_7: ───────────────────────────────────────────────────────────────────────────»
«                                                                                 »
«q2_8: ───────────────────────────────────────────────────────────────────────────»
«                                                                                 »
«c2: 9/═══════════════════════════════════════════════════════════════════════════»
«                                                                                 »
«                                                                                 »
«q2_0: ───────────────────────────────────────────────────────────────────────────»
«                                           ┌────────────┐┌───┐┌────────────┐     »
«q2_1: ──────────────────────────────────■──┤ Ry(3.8038) ├┤ X ├┤ Ry(4.9307) ├──■──»
«        ┌──────────────────────────┐  ┌─┴─┐├────────────┤└─┬─┘└────────────┘┌─┴─┐»
«q2_2: ──┤ U3(0.65344,3.9727,6.886) ├──┤ X ├┤ Rz(3.0912) ├──■────────────────┤ X ├»
«       ┌┴──────────────────────────┤  └───┘└────┬─┬─────┘                   └───┘»
«q2_3: ─┤ U3(0.99679,5.5945,3.7461) ├────────────┤M├──────────────────────────────»
«      ┌┴───────────────────────────┴─┐          └╥┘       ┌─┐                    »
«q2_4: ┤ U3(-0.29953,-0.25002,4.8387) ├───────────╫────────┤M├────────────────────»
«      └──┬────────────────────────┬──┘┌───┐      ║        └╥┘ ┌────────────┐     »
«q2_5: ───┤ U3(2.547,3.55,0.60107) ├───┤ X ├──────╫─────────╫──┤ Rz(4.0322) ├──■──»
«         └────────────────────────┘   └─┬─┘      ║         ║  ├────────────┤┌─┴─┐»
«q2_6: ──────────────────────────────────■────────╫─────────╫──┤ Ry(4.7104) ├┤ X ├»
«                                                 ║         ║  └────────────┘└───┘»
«q2_7: ───────────────────────────────────────────╫─────────╫─────────────────────»
«                                                 ║         ║                     »
«q2_8: ───────────────────────────────────────────╫─────────╫─────────────────────»
«                                                 ║         ║                     »
«c2: 9/═══════════════════════════════════════════╩═════════╩═════════════════════»
«                                                 3         4                     »
«                                                     ┌────────────┐        ┌───┐┌────────────┐     »
«q2_0: ───────────────────────────────────■───────────┤ Ry(4.6314) ├────────┤ X ├┤ Ry(1.5822) ├──■──»
«        ┌───────────────────────────┐  ┌─┴─┐         ├───────────┬┘        └─┬─┘└────────────┘┌─┴─┐»
«q2_1: ──┤ U3(0.55398,6.3521,5.7348) ├──┤ X ├─────────┤ Rz(3.516) ├───────────■────────────────┤ X ├»
«      ┌─┴───────────────────────────┴─┐└───┘         └───────────┘                   ┌─┐      └───┘»
«q2_2: ┤ U3(3.8211,-1.4551,-0.0096801) ├──────────────────────────────────────────────┤M├───────────»
«      └───────────────────────────────┘                                              └╥┘           »
«q2_3: ────────────────────────────────────────────────────────────────────────────────╫────────────»
«                                                                                      ║            »
«q2_4: ────────────────────────────────────────────────────────────────────────────────╫────────────»
«                                       ┌───┐┌─────────────────────────────┐           ║        ┌─┐ »
«q2_5: ─────────────────────────────────┤ X ├┤ U3(0.56302,-2.0711,0.99718) ├───────────╫────────┤M├─»
«               ┌─────────────┐         └─┬─┘└┬───────────────────────────┬┘┌───┐      ║        └╥┘ »
«q2_6: ─────────┤ Ry(-1.4537) ├───────────■───┤ U3(5.6811,0.33145,8.0742) ├─┤ X ├──────╫─────────╫──»
«               └─────────────┘               └───────────────────────────┘ └─┬─┘      ║         ║  »
«q2_7: ───────────────────────────────────────────────────────────────────────■────────╫─────────╫──»
«                                                                                      ║         ║  »
«q2_8: ────────────────────────────────────────────────────────────────────────────────╫─────────╫──»
«                                                                                      ║         ║  »
«c2: 9/════════════════════════════════════════════════════════════════════════════════╩═════════╩══»
«                                                                                      2         5  »
«      ┌──────────────────────────┐                                                             ┌─┐»
«q2_0: ┤ U3(4.9844,5.8679,3.6173) ├─────────────────────────────────────────────────────────────┤M├»
«      ├─────────────────────────┬┘                                                             └╥┘»
«q2_1: ┤ U3(3.2717,4.6411,5.061) ├───────────────────────────────────────────────────────────────╫─»
«      └─────────────────────────┘                                                               ║ »
«q2_2: ──────────────────────────────────────────────────────────────────────────────────────────╫─»
«                                                                                                ║ »
«q2_3: ──────────────────────────────────────────────────────────────────────────────────────────╫─»
«                                                                                                ║ »
«q2_4: ──────────────────────────────────────────────────────────────────────────────────────────╫─»
«                                                                                                ║ »
«q2_5: ──────────────────────────────────────────────────────────────────────────────────────────╫─»
«            ┌─────────────┐                          ┌───┐┌──────────────────────────────┐      ║ »
«q2_6: ──────┤ Rz(0.27455) ├─────────■────────────────┤ X ├┤ U3(0.55839,-0.087088,3.5152) ├──────╫─»
«            └┬────────────┤       ┌─┴─┐┌────────────┐└─┬─┘└┬───────────────────────────┬─┘┌───┐ ║ »
«q2_7: ───────┤ Ry(1.4089) ├───────┤ X ├┤ Ry(3.0572) ├──■───┤ U3(0.27895,2.3576,1.5817) ├──┤ X ├─╫─»
«             └────────────┘       └───┘└────────────┘      └───────────────────────────┘  └─┬─┘ ║ »
«q2_8: ──────────────────────────────────────────────────────────────────────────────────────■───╫─»
«                                                                                                ║ »
«c2: 9/══════════════════════════════════════════════════════════════════════════════════════════╩═»
«                                                                                                0 »
«                                                                                      
«q2_0: ────────────────────────────────────────────────────────────────────────────────
«      ┌─┐                                                                             
«q2_1: ┤M├─────────────────────────────────────────────────────────────────────────────
«      └╥┘                                                                             
«q2_2: ─╫──────────────────────────────────────────────────────────────────────────────
«       ║                                                                              
«q2_3: ─╫──────────────────────────────────────────────────────────────────────────────
«       ║                                                                              
«q2_4: ─╫──────────────────────────────────────────────────────────────────────────────
«       ║                                                                              
«q2_5: ─╫──────────────────────────────────────────────────────────────────────────────
«       ║ ┌─┐                                                                          
«q2_6: ─╫─┤M├──────────────────────────────────────────────────────────────────────────
«       ║ └╥┘┌────────────┐                   ┌───┐┌────────────────────────────┐┌─┐   
«q2_7: ─╫──╫─┤ Rz(4.9881) ├──■────────────────┤ X ├┤ U3(1.3831,-1.7975,0.53432) ├┤M├───
«       ║  ║ ├────────────┤┌─┴─┐┌────────────┐└─┬─┘├───────────────────────────┬┘└╥┘┌─┐
«q2_8: ─╫──╫─┤ Ry(2.1057) ├┤ X ├┤ Ry(2.8124) ├──■──┤ U3(1.8948,5.5681,0.26911) ├──╫─┤M├
«       ║  ║ └────────────┘└───┘└────────────┘     └───────────────────────────┘  ║ └╥┘
«c2: 9/═╩══╩══════════════════════════════════════════════════════════════════════╩══╩═
«       1  6                                                                      7  8 </code></pre><h2 id=".2-Stage-1-optimization"><a class="docs-heading-anchor" href="#.2-Stage-1-optimization">3.2 Stage 1 - optimization</a><a id=".2-Stage-1-optimization-1"></a><a class="docs-heading-anchor-permalink" href="#.2-Stage-1-optimization" title="Permalink"></a></h2><p>During the first stage of optimization, we use evenly distributed discretization. There are two reasons for that:</p><ul><li>First, because our problem is fewer parameters we need fewer optimization steps to find a good solution.</li><li>Second, for constant discretization, we need to calculate the desired probability distribution once and use it in every loss function call. Therefore each step of optimization takes less time.</li></ul><p>Create the desired probability distribution:</p><pre><code class="language-julia hljs">dx = diss_x[2] - diss_x[1]
ADDN = 2^10
const diss_y_pldf = zeros(2^N, ADDN)
for j in 1:2^N 
    for i in 0:ADDN-1
        x = diss_x[j] + i/ADDN * dx
        diss_y_pldf[j, i+1] = pldf(x)
    end
end</code></pre><p>Now we can create the loss function.</p><pre><code class="language-julia hljs">function loss_l2_Δ(state)
    err = 0   
    n = length(state) 
    for j in 1:n #(x_val, p_val) in zip(diss_x[1:end-1], state)
        for i in 0:ADDN-1
            err += (diss_y_pldf[j, i+1] - state[j]/dx)^2 * dx/ADDN
        end
    end
    sqrt(err)    
end

function loss_stage1(params)
    start = ket&quot;000000000&quot;
    mat = tomatrix(qc, params)
    state_end = state2probability(mat * start)
    
    return loss_l2_Δ(state_end)
end</code></pre><p>And finally, we start the optimization.</p><pre><code class="language-julia hljs">val, x, itr = gradientDescent(loss_stage1, loss_stage1&#39;, params, α=0.0001, maxItr=500, debug=true,
                              useBigValInc=true, argsArePeriodic=true)</code></pre><h2 id=".3-Stage-2-optimization"><a class="docs-heading-anchor" href="#.3-Stage-2-optimization">3.3 Stage 2 - optimization</a><a id=".3-Stage-2-optimization-1"></a><a class="docs-heading-anchor-permalink" href="#.3-Stage-2-optimization" title="Permalink"></a></h2><p>In stage one we found the parameter which works well in the evenly distributed discretization. But we can change the discretization method as well, so we treat the discretization as a problem parameter in optimization. We encode the parameters in three parts: </p><ul><li>First is the start value of discretization</li><li>Next, we have the array of difference values between two points in discretization</li><li>And the last part is the ansact/model parameters.</li></ul><p>To start the optimization we use the parameters and discretization from stage 1.</p><pre><code class="language-julia hljs">params = vcat([start_val], [dx for i in 1:512], best_param)</code></pre><p>Now we can create the loss function. There is a slight modification to the previously lost function, we have added a penalty function to ensure that the start and end values will not be too small and too big.</p><pre><code class="language-julia hljs">function loss_l2(state, start, Δx)
    err = 0   
    n = length(state) 
    xx = start
    for j in 1:n 
        dx = Δx[j]
        for i in 0:ADDN-1
            x = xx + i/ADDN * dx
            err += (pldf(x) - state[j]/dx)^2 * dx/ADDN
        end
        xx += dx
    end
    err += 1 - cldf(xx)
    err += cldf(start)
    sqrt(err) + max(xx - 1.75, 0) + max(0.57 - start, 0)
end

function loss(params)
    Δx = abs.(params[2:513])
    model_param = params[514:end]
    start = ket&quot;000000000&quot;
    mat = tomatrix(qc, model_param)
    #state_end = qc.measures_matrix * state2probability(mat * start)
    state_end = state2probability(mat * start)
    
    #return 100*loss_mse(state_end, diss_p)
    return loss_l2(state_end, abs(params[1]), Δx)    
end</code></pre><p>And finally, we start the optimization.</p><p>During the optimization, we save in the log the best parameters found till now. Bat sometimes the optimization method cannot find a better point so, in that case, it is good to restart it from the best parameters found lastly.</p><pre><code class="language-julia hljs">val, x, itr = gradientDescent(loss, loss&#39;, params, α=0.0000001, maxItr=500, debug=true,
                              useBigValInc=true, argsArePeriodic=true)</code></pre><h2 id=".4-Export-solution"><a class="docs-heading-anchor" href="#.4-Export-solution">3.4 Export solution</a><a id=".4-Export-solution-1"></a><a class="docs-heading-anchor-permalink" href="#.4-Export-solution" title="Permalink"></a></h2><p>Now we have to export or solution to Python, first we calculate the discretization.</p><pre><code class="language-julia hljs"># Generate the discretization and check the final results
Δx_param = abs.(params[2:513])
opt_x = zeros(513)
opt_x[1] = abs(params[1])
for i in 1:length(Δx_param)
    opt_x[i+1] = opt_x[i] + Δx_param[i]
end

# Print the discretization
println(opt_x)</code></pre><p>And finaly we generate the Python Qiskit code of the ansact circuit with the best parameters.</p><pre><code class="language-julia hljs">println(toPythonQiskitCode(qc))</code></pre><pre><code class="language-python hljs">qr1 = QuantumRegister(9)
cr1 = ClassicalRegister(9)
qc = QuantumCircuit(qr1, cr1)
qc.u3(5.679770217925697, 4.251016852930093, 3.5437338099599174, 0)
qc.u3(5.4414444305521865, 2.354307135256903, 1.2375106360535937, 1)
qc.u3(-5.926509974424452, 5.105579985273053, 6.220803793450637, 2)
qc.u3(-4.7314616203642075, 1.8798682031836234, 5.5737349030831105, 3)
qc.u3(3.201179776528541, 1.753779628606808, 2.276393940822889, 4)
qc.cx(3, 4)
qc.ry(6.4337424520833295, 3)
qc.rz(1.8803472065474063, 4)
qc.cx(4, 3)
qc.ry(1.37622694809517, 3)
qc.cx(3, 4)
qc.u3(2.111479170265415, 2.647643433365171, 5.302181247182872, 3)
qc.cx(2, 3)
qc.ry(-0.6554348594430898, 2)
qc.rz(1.9142676280384965, 3)
qc.cx(3, 2)
qc.ry(6.10046184925552, 2)
qc.cx(2, 3)
qc.u3(0.653441307827227, 3.972677408951232, 6.8859818579008865, 2)
qc.cx(1, 2)
qc.ry(3.8038146362032093, 1)
qc.rz(3.0912079807503754, 2)
qc.cx(2, 1)
qc.ry(4.930723984116728, 1)
qc.cx(1, 2)
qc.u3(0.5539812892044788, 6.3521240785694975, 5.734803410944227, 1)
qc.cx(0, 1)
qc.ry(4.631396211030235, 0)
qc.rz(3.5160160070405357, 1)
qc.cx(1, 0)
qc.ry(1.5822384837667445, 0)
qc.cx(0, 1)
qc.u3(4.984363180126585, 5.867871515378414, 3.6173393724017853, 0)
qc.u3(3.2716835155406696, 4.64111910105604, 5.061027693997932, 1)
qc.u3(3.821114354775824, -1.4551420517097016, -0.009680068910482396, 2)
qc.u3(0.996787111078856, 5.594528591259475, 3.7461283499644282, 3)
qc.u3(3.617111888578461, -0.8880106139940267, 1.67043976315479, 4)
qc.u3(2.287238539333411, 5.511579494499221, 0.5714521142705539, 5)
qc.cx(5, 4)
qc.rz(3.802725492932484, 4)
qc.ry(0.47130547011305796, 5)
qc.cx(4, 5)
qc.ry(4.97332952918446, 5)
qc.cx(5, 4)
qc.u3(-0.29953259079769096, -0.25001889490376006, 4.838712232639852, 4)
qc.u3(2.5470329143628603, 3.549985645444483, 0.6010744636307404, 5)
qc.u3(5.610669656210048, -0.24548376869623095, 1.3413055441945323, 6)
qc.cx(6, 5)
qc.rz(4.032151127065874, 5)
qc.ry(4.7104087155607095, 6)
qc.cx(5, 6)
qc.ry(-1.4537100582360183, 6)
qc.cx(6, 5)
qc.u3(0.563020725313747, -2.07108824150549, 0.997181039950089, 5)
qc.u3(5.681055401024746, 0.33144537477752495, 8.074229094966102, 6)
qc.u3(4.037738446851733, 1.806980350762186, 4.351954781482624, 7)
qc.cx(7, 6)
qc.rz(0.2745523724520492, 6)
qc.ry(1.4089227530864126, 7)
qc.cx(6, 7)
qc.ry(3.057200171651369, 7)
qc.cx(7, 6)
qc.u3(0.5583868988591522, -0.08708818785242389, 3.5151991456138365, 6)
qc.u3(0.2789465162342843, 2.3576112389327166, 1.581734903155837, 7)
qc.u3(6.553041368749906, 5.636391301613432, 2.2812658090447404, 8)
qc.cx(8, 7)
qc.rz(4.988148484777791, 7)
qc.ry(2.1057427438462026, 8)
qc.cx(7, 8)
qc.ry(2.8124362586259126, 8)
qc.cx(8, 7)
qc.u3(1.383133441772288, -1.7975187312537604, 0.5343188007447871, 7)
qc.u3(1.894759150030361, 5.568083164220874, 0.2691081343450627, 8)
qc.measure(0, 0)
qc.measure(1, 1)
qc.measure(2, 2)
qc.measure(3, 3)
qc.measure(4, 4)
qc.measure(5, 5)
qc.measure(6, 6)
qc.measure(7, 7)
qc.measure(8, 8)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Simulation/Trotterization/">« Algorithm description</a><a class="docs-footer-nextpage" href="../../QCircuits/Circuit/">Circuit »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Tuesday 14 June 2022 17:21">Tuesday 14 June 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
